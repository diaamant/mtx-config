# Mediamtx Configuration Editor

## Обзор

Интерактивное веб-приложение на Python с использованием фреймворка **NiceGUI** для визуализации, редактирования и сохранения настроек сервера `mediamtx`. Приложение обеспечивает интуитивно понятный интерфейс для управления сложной конфигурацией `mediamtx.yml`.

## Особенности

-   **Визуальное редактирование:** Удобный интерфейс с вкладками для редактирования всех разделов конфигурации `mediamtx`.
-   **Динамическая генерация полей:** Автоматическое создание полей ввода (input, checkbox, textarea) в зависимости от типа данных в конфигурации.
-   **Управление потоками (Paths):** Специализированная вкладка для добавления, редактирования и удаления потоков.
-   **Сохранение и бэкап:** Генерация финального `mediamtx.yml` и автоматическое создание бэкапа предыдущей версии.
-   **Модульная структура:** Код разделен на логические модули для упрощения поддержки и расширения.

## Технологический стек

-   **Python 3.12+**
-   **NiceGUI**: Основной фреймворк для UI.
-   **PyYAML**: Для финальной генерации `.yml` файла.
-   **uv**: Для управления виртуальной средой и зависимостями.

## Установка и запуск

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <repository-url>
    cd mtx-config
    ```

2.  **Создайте и активируйте виртуальную среду:**
    ```bash
    python3 -m venv .venv
    source .venv/bin/activate
    ```

3.  **Установите зависимости с помощью `uv`:**
    ```bash
    pip install uv
    uv pip install -r requirements.txt
    ```

4.  **Запустите приложение:**
    ```bash
    python3 src/app.py
    ```

    Приложение будет доступно по адресу `http://localhost:8080`.

## Структура проекта

```
mediamtx-configurator/
├── src/
│   ├── app.py              # <--- Основной файл приложения NiceGUI
│   ├── main.py             # <--- Скрипт-парсер для начальной генерации JSON
│   ├── utils/
│   │   └── json_utils.py   # <--- Функции для загрузки/сохранения JSON и YAML
│   └── ui_components/
│       ├── __init__.py
│       ├── generic_tab.py  # <--- Логика для генерации общих вкладок
│       ├── paths_tab.py    # <--- Логика для вкладки "Paths"
│       └── ui_utils.py     # <--- Вспомогательные UI-функции (создание элементов)
├── work/
│   ├── mediamtx01.yml      # <--- Финальный результат
│   └── json/
│       ├── auth.json
│       ├── paths.json
│       └── ... (остальные json файлы)
└── requirements.txt
```

## Как это работает

1.  **Источник данных:** Приложение работает с набором `.json` файлов в каталоге `work/json/`. Эти файлы представляют собой разделенные по категориям части конфигурации `mediamtx`.
2.  **Интерфейс:** `app.py` запускает веб-сервер и строит интерфейс, используя компоненты из `src/ui_components`.
3.  **Редактирование:** Пользователь вносит изменения в поля ввода. Все изменения сохраняются в словаре `data` в памяти.
4.  **Сохранение:** При нажатии кнопки "Сохранить":
    -   Данные из словаря `data` записываются обратно в `.json` файлы.
    -   Создается бэкап `mediamtx01.yml.bak`.
    -   Все `.json` файлы (которые отмечены как "включенные") собираются в один словарь.
    -   Финальный словарь конвертируется в YAML и сохраняется в `work/mediamtx01.yml`.
