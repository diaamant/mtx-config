# mediamtx_v1.14.0

logLevel: info
logDestinations: [stdout]
logFile: mediamtx.log
sysLogPrefix: mediamtx

readTimeout: 10s
writeTimeout: 10s
writeQueueSize: 512
udpMaxPayloadSize: 1472

runOnConnect:
runOnConnectRestart: no
runOnDisconnect:

authMethod: internal

authInternalUsers:
- user: unit058
  pass: 1KZez0Vo7Cid
  ips: ['127.0.0.1', '::1', '10.23.254.22', '192.168.1.0/24', '10.8.0.0/24', '10.8.1.0/24', '192.168.8.0/24', '192.168.137.0/24']
  permissions:
  - action: publish
    path:
  - action: read
    path:
  - action: playback
    path:

- user: admin01
  pass: admin01
  ips: ['127.0.0.1', '::1']
  permissions:
  - action: api
  - action: metrics
  - action: pprof

authHTTPAddress:
authHTTPExclude:
- action: api
- action: metrics
- action: pprof

authJWTJWKS:
authJWTJWKSFingerprint:
authJWTClaimKey: mediamtx_permissions
authJWTExclude: []
authJWTInHTTPQuery: true


api: no
apiAddress: :9997
apiEncryption: no
apiServerKey: server.key
apiServerCert: server.crt
apiAllowOrigin: '*'
apiTrustedProxies: []


metrics: no
metricsAddress: :9998
metricsEncryption: no
metricsServerKey: server.key
metricsServerCert: server.crt
metricsAllowOrigin: '*'
metricsTrustedProxies: []


pprof: no
pprofAddress: :9999
pprofEncryption: no
pprofServerKey: server.key
pprofServerCert: server.crt
pprofAllowOrigin: '*'
pprofTrustedProxies: []


playback: no
playbackAddress: :9996
playbackEncryption: no
playbackServerKey: server.key
playbackServerCert: server.crt
playbackAllowOrigin: '*'
playbackTrustedProxies: []


rtsp: yes
rtspTransports: [udp, multicast, tcp]
rtspEncryption: "no"
rtspAddress: :8554
rtspsAddress: :8322
rtpAddress: :8000
rtcpAddress: :8001
multicastIPRange: 224.1.0.0/16
multicastRTPPort: 8002
multicastRTCPPort: 8003
srtpAddress: :8004
srtcpAddress: :8005
multicastSRTPPort: 8006
multicastSRTCPPort: 8007
rtspServerKey: server.key
rtspServerCert: server.crt
rtspAuthMethods: [basic]
rtspUDPReadBufferSize: 0


rtmp: no
rtmpAddress: :1935
rtmpEncryption: "no"
rtmpsAddress: :1936
rtmpServerKey: server.key
rtmpServerCert: server.crt


hls: no
hlsAddress: :8888
hlsEncryption: no
hlsServerKey: server.key
hlsServerCert: server.crt
hlsAllowOrigin: '*'
hlsTrustedProxies: []
hlsAlwaysRemux: no
hlsVariant: lowLatency
hlsSegmentCount: 7
hlsSegmentDuration: 1s
hlsPartDuration: 200ms
hlsSegmentMaxSize: 50M
hlsDirectory: ''
hlsMuxerCloseAfter: 60s


webrtc: yes
webrtcAddress: :8889
webrtcEncryption: no
webrtcServerKey: server.key
webrtcServerCert: server.crt
webrtcAllowOrigin: '*'
webrtcTrustedProxies: []
webrtcLocalUDPAddress: :8189
webrtcLocalTCPAddress: ''
webrtcIPsFromInterfaces: yes
# webrtcIPsFromInterfacesList: []
webrtcIPsFromInterfacesList:
  - wg0     # WireGuard
# webrtcAdditionalHosts: []
webrtcAdditionalHosts:
  - 127.0.0.1        # localhost
  - 192.168.1.11     # Ethernet
  - 192.168.137.1    # Wi-Fi
  - 10.23.254.6      # LTE
webrtcICEServers2: []
webrtcHandshakeTimeout: 15s
webrtcTrackGatherTimeout: 5s
webrtcSTUNGatherTimeout: 0s


srt: yes
srtAddress: :8890


pathDefaults:


  source: publisher
  sourceFingerprint:
  sourceOnDemand: no
  sourceOnDemandStartTimeout: 10s
  sourceOnDemandCloseAfter: 10s
  maxReaders: 0
  srtReadPassphrase:
  fallback:
  useAbsoluteTimestamp: false


  record: no
  recordPath: ./recordings/%path/%Y-%m-%d_%H-%M-%S-%f
  recordFormat: fmp4
  recordPartDuration: 1s
  recordMaxPartSize: 50M
  recordSegmentDuration: 1h
  recordDeleteAfter: 1d

  overridePublisher: yes
  srtPublishPassphrase:

  rtspTransport: automatic
  rtspAnyPort: yes
  rtspRangeType:
  rtspRangeStart:
  rtspUDPReadBufferSize: 0

  mpegtsUDPReadBufferSize: 0

  rtpSDP:
  rtpUDPReadBufferSize: 0

  sourceRedirect:

  rpiCameraCamID: 0
  rpiCameraSecondary: false
  rpiCameraWidth: 1920
  rpiCameraHeight: 1080
  rpiCameraHFlip: false
  rpiCameraVFlip: false
  rpiCameraBrightness: 0
  rpiCameraContrast: 1
  rpiCameraSaturation: 1
  rpiCameraSharpness: 1
  rpiCameraExposure: normal
  rpiCameraAWB: auto
  rpiCameraAWBGains: [0, 0]
  rpiCameraDenoise: "off"
  rpiCameraShutter: 0
  rpiCameraMetering: centre
  rpiCameraGain: 0
  rpiCameraEV: 0
  rpiCameraROI:
  rpiCameraHDR: false
  rpiCameraTuningFile:
  rpiCameraMode:
  rpiCameraFPS: 30
  rpiCameraAfMode: continuous
  rpiCameraAfRange: normal
  rpiCameraAfSpeed: normal
  rpiCameraLensPosition: 0.0
  rpiCameraAfWindow:
  rpiCameraFlickerPeriod: 0
  rpiCameraTextOverlayEnable: false
  rpiCameraTextOverlay: '%Y-%m-%d %H:%M:%S - MediaMTX'
  rpiCameraCodec: auto
  rpiCameraIDRPeriod: 60
  rpiCameraBitrate: 5000000
  rpiCameraHardwareH264Profile: main
  rpiCameraHardwareH264Level: '4.1'
  rpiCameraSoftwareH264Profile: baseline
  rpiCameraSoftwareH264Level: '4.1'
  rpiCameraMJPEGQuality: 60

  runOnInit:
  runOnInitRestart: no

  runOnDemand:
  runOnDemandRestart: no
  runOnDemandStartTimeout: 10s
  runOnDemandCloseAfter: 10s
  runOnUnDemand:

  runOnReady:
  runOnReadyRestart: no
  runOnNotReady:

  runOnRead:
  runOnReadRestart: no
  runOnUnread:

  runOnRecordSegmentCreate:

  runOnRecordSegmentComplete:


paths:

# video

  vh:
    source: rtsp://root:ipc@ipc:554/stream=0
    # source: rtsp://admin:admin@192.168.1.123/av0_0
    # source: rtsp://192.168.8.161:554/user=admin&password=Imx&&307&channel=1&stream=0.sdp
    rtspTransport: tcp
    sourceOnDemand: true


  avh:
    runOnDemand: gst-launch-1.0 pulsesrc device=alsa_input.usb-0c76_USB_PnP_Audio_Device-00.mono-fallback do-timestamp=true volume=1.0 buffer-time=2000000 ! queue name=audio_source  audio_source. ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! opusenc bandwidth=1104 bitrate=64000 bitrate-type=1 inband-fec=FALSE packet-loss-percentage=0 dtx=FALSE ! queue ! opusparse ! queue ! sink. urisourcebin uri="rtsp://unit057:1KZez0Vo7Cid@127.0.0.1:$RTSP_PORT/vh" ! queue ! application/x-rtp,media=video ! queue ! parsebin ! queue ! h264parse ! queue ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/avh
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 9s


  vl:
    source: rtsp://root:ipc@ipc:554/stream=1
    # source: rtsp://admin:admin@192.168.1.123/av0_1
    # source: rtsp://192.168.8.161:554/user=admin&password=Imx&&307&channel=1&stream=1.sdp
    rtspTransport: tcp
    sourceOnDemand: true

  avl:
    runOnDemand: gst-launch-1.0 pulsesrc device=alsa_input.usb-0c76_USB_PnP_Audio_Device-00.mono-fallback do-timestamp=true volume=1.0 buffer-time=2000000 ! queue name=audio_source  audio_source. ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! opusenc bandwidth=1104 bitrate=64000 bitrate-type=1 inband-fec=FALSE packet-loss-percentage=0 dtx=FALSE ! queue ! opusparse ! queue ! sink. urisourcebin uri="rtsp://unit057:1KZez0Vo7Cid@127.0.0.1:$RTSP_PORT/vl" ! queue ! application/x-rtp,media=video ! queue ! parsebin ! queue ! h264parse ! queue ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/avl
    runOnReadyRestart: yes
    runOnDemandStartTimeout: 9s


  ahd01H:
    source: rtsp://192.168.10.121:554/user=user01&password=user01&channel=1&stream=0.sdp
    sourceOnDemand: yes

  ahd01L:
    source: rtsp://192.168.10.121:554/user=user01&password=user01&channel=1&stream=1.sdp
    sourceOnDemand: yes

  dh01H:
    source: rtsp://user01:user01@192.168.10.121:554/cam/realmonitor?channel=1&subtype=0
    rtspTransport: tcp
    sourceOnDemand: yes

  dh01L:
    source: rtsp://user01:user01@192.168.10.121:554/cam/realmonitor?channel=1&subtype=1
    rtspTransport: tcp
    sourceOnDemand: yes

  vgh0:
    runOnDemand: gst-launch-1.0 rtspsrc location="rtsp://root:ipc@192.168.1.123:554/stream=0" name=src01 ! rtpjitterbuffer latency=100 ! queue ! rtph265depay ! h265parse ! rtspclientsink location=rtsp://unit057:1KZez0Vo7Cid@localhost:8554/vgh0
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s

  vgh:
    runOnDemand: gst-launch-1.0 rtspsrc location="rtsp://root:ipc@192.168.1.123:554/stream=0" name=src01 ! rtpjitterbuffer latency=100 ! queue ! rtph265depay ! h265parse ! rtspclientsink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s

  vgl:
    runOnDemand: gst-launch-1.0 rtspsrc name=rtspsrc01 location="rtsp://root:ipc@192.168.1.123:554/stream=1" rtspsrc01. ! application/x-rtp,media=video ! rtpjitterbuffer latency=100 ! queue ! parsebin ! queue ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s

    # Audio

  opus:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! opusenc audio-type=2048 bandwidth=1104 bitrate=96000 bitrate-type=1 inband-fec=FALSE packet-loss-percentage=0 dtx=FALSE ! opusparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 7s

  opus02:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.analog-stereo" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! opusenc audio-type=2048 bandwidth=1104 bitrate=96000 bitrate-type=1 inband-fec=FALSE packet-loss-percentage=0 dtx=FALSE ! opusparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 7s


  snd:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! voaacenc bitrate=32000 ! aacparse ! queue ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: true
    runOnDemandStartTimeout: 7s
    runOnDemandCloseAfter: 1s

  snd01:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue ! audioconvert ! queue ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue ! voaacenc bitrate=32000 ! aacparse ! queue ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: true
    runOnDemandStartTimeout: 7s
    runOnDemandCloseAfter: 1s

  snd02:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.analog-stereo" do-timestamp=true volume=1.0 ! audio/x-raw, channels=2, rate=48000 ! queue name=queue01a ! audioconvert ! queue name=queue02a ! audioresample ! audio/x-raw, channels=2, rate=24000 ! queue name=queue03a ! voaacenc bitrate=32000 ! aacparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s
    runOnDemandCloseAfter: 1s

  BY-M3D:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_PnP_Audio_Device-00.analog-stereo" do-timestamp=true volume=1.0 ! audio/x-raw, channels=2, rate=48000 ! queue name=queue01a ! audioconvert ! queue name=queue02a ! audioresample ! audio/x-raw, channels=2, rate=24000 ! queue name=queue03a ! voaacenc bitrate=32000 ! aacparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s
    runOnDemandCloseAfter: 1s

  snd03:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-KTMicro_BY-LM40_214b206000000178-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue name=queue01a ! audioconvert ! queue name=queue02a ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue name=queue03a ! voaacenc bitrate=32000 ! aacparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 7s
    runOnDemandCloseAfter: 1s

  BY-LM40:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-KTMicro_BY-LM40_214b206000000178-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=48000 ! queue name=queue01a ! audioconvert ! queue name=queue02a ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue name=queue03a ! voaacenc bitrate=32000 ! aacparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 7s


  JMTek01:
    runOnDemand: gst-launch-1.0 pulsesrc device="alsa_input.usb-0c76_USB_Audio_Device-00.mono-fallback" do-timestamp=true volume=1.0 ! audio/x-raw, channels=1, rate=44100 ! queue name=queue01a ! audioconvert ! queue name=queue02a ! audioresample ! audio/x-raw, channels=1, rate=24000 ! queue name=queue03a ! voaacenc bitrate=32000 ! aacparse ! queue name=mq01 ! sink. rtspclientsink name=sink location=rtsp://unit057:1KZez0Vo7Cid@localhost:$RTSP_PORT/$RTSP_PATH
    runOnDemandRestart: yes
    runOnDemandStartTimeout: 5s
    runOnDemandCloseAfter: 1s


